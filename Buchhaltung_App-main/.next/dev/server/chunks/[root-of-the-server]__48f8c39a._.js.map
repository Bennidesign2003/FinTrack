{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Buchhaltung_App/Buchhaltung_App-main/db/schema.ts"],"sourcesContent":["import { sqliteTable, text, real, integer, sqliteView } from 'drizzle-orm/sqlite-core'\nimport { sql } from 'drizzle-orm'\n\nexport const invoices = sqliteTable('invoices', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  customer: text('customer').notNull(),\n  title: text('title').notNull().default(''),\n  amount: real('amount').notNull(),\n  taxRate: real('tax_rate').notNull().default(19),\n  taxAmount: real('tax_amount').notNull().default(0),\n  totalAmount: real('total_amount').notNull(),\n  dueDate: text('due_date'),\n  description: text('description'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  updatedAt: text('updated_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  status: text('status').default('open').notNull() // 'open', 'paid', 'overdue'\n})\n\nexport const expenses = sqliteTable('expenses', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  category: text('category').notNull(),\n  amount: real('amount').notNull(),\n  date: text('date'),\n  description: text('description'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull()\n})\n\nexport const customers = sqliteTable('customers', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  name: text('name').notNull().unique(),\n  email: text('email'),\n  phone: text('phone'),\n  address: text('address'),\n  city: text('city'),\n  postalCode: text('postal_code'),\n  country: text('country'),\n  taxId: text('tax_id'),\n  notes: text('notes'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  updatedAt: text('updated_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull()\n})\n\nexport const suppliers = sqliteTable('suppliers', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  name: text('name').notNull().unique(),\n  email: text('email'),\n  phone: text('phone'),\n  address: text('address'),\n  city: text('city'),\n  postalCode: text('postal_code'),\n  country: text('country'),\n  taxId: text('tax_id'),\n  notes: text('notes'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  updatedAt: text('updated_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull()\n})\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;;;;;;AAEO,MAAM,WAAW,IAAA,+KAAW,EAAC,YAAY;IAC9C,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,UAAU,IAAA,wKAAI,EAAC,YAAY,OAAO;IAClC,OAAO,IAAA,wKAAI,EAAC,SAAS,OAAO,GAAG,OAAO,CAAC;IACvC,QAAQ,IAAA,wKAAI,EAAC,UAAU,OAAO;IAC9B,SAAS,IAAA,wKAAI,EAAC,YAAY,OAAO,GAAG,OAAO,CAAC;IAC5C,WAAW,IAAA,wKAAI,EAAC,cAAc,OAAO,GAAG,OAAO,CAAC;IAChD,aAAa,IAAA,wKAAI,EAAC,gBAAgB,OAAO;IACzC,SAAS,IAAA,wKAAI,EAAC;IACd,aAAa,IAAA,wKAAI,EAAC;IAClB,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,QAAQ,IAAA,wKAAI,EAAC,UAAU,OAAO,CAAC,QAAQ,OAAO,GAAG,4BAA4B;AAC/E;AAEO,MAAM,WAAW,IAAA,+KAAW,EAAC,YAAY;IAC9C,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,UAAU,IAAA,wKAAI,EAAC,YAAY,OAAO;IAClC,QAAQ,IAAA,wKAAI,EAAC,UAAU,OAAO;IAC9B,MAAM,IAAA,wKAAI,EAAC;IACX,aAAa,IAAA,wKAAI,EAAC;IAClB,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;AACZ;AAEO,MAAM,YAAY,IAAA,+KAAW,EAAC,aAAa;IAChD,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,MAAM,IAAA,wKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,SAAS,IAAA,wKAAI,EAAC;IACd,MAAM,IAAA,wKAAI,EAAC;IACX,YAAY,IAAA,wKAAI,EAAC;IACjB,SAAS,IAAA,wKAAI,EAAC;IACd,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;AACZ;AAEO,MAAM,YAAY,IAAA,+KAAW,EAAC,aAAa;IAChD,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,MAAM,IAAA,wKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,SAAS,IAAA,wKAAI,EAAC;IACd,MAAM,IAAA,wKAAI,EAAC;IACX,YAAY,IAAA,wKAAI,EAAC;IACjB,SAAS,IAAA,wKAAI,EAAC;IACd,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;AACZ"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Buchhaltung_App/Buchhaltung_App-main/db/index.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport { drizzle } from 'drizzle-orm/better-sqlite3'\nimport * as schema from './schema'\n\nconst sqlite = new Database('buchhaltung.db')\nexport const db = drizzle(sqlite, { schema })\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,SAAS,IAAI,sIAAQ,CAAC;AACrB,MAAM,KAAK,IAAA,iLAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Buchhaltung_App/Buchhaltung_App-main/pages/api/expenses.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next'\nimport { db } from '@/db'\nimport { expenses } from '@/db/schema'\nimport { eq } from 'drizzle-orm'\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method === 'POST') {\n    try {\n      const { category, amount, date, description } = req.body\n      const parsedAmount = Number(amount)\n\n      if (!category || Number.isNaN(parsedAmount)) {\n        return res.status(400).json({ error: 'category und amount sind erforderlich' })\n      }\n\n      const result = await db\n        .insert(expenses)\n        .values({\n          category,\n          amount: parsedAmount,\n          date: date || new Date().toISOString().split('T')[0],\n          description: description || null\n        })\n        .run()\n\n      // Fetch the created expense by using the last inserted rowid\n      const created = await db\n        .select()\n        .from(expenses)\n        .where(eq(expenses.id, result.lastInsertRowid as number))\n        .get()\n\n      const normalizedExpense = {\n        ...created,\n        amount: Number(created?.amount)\n      }\n\n      return res.status(201).json(normalizedExpense)\n    } catch (error) {\n      console.error('Error creating expense:', error)\n      return res.status(500).json({ error: 'Fehler beim Erstellen der Ausgabe', details: String(error) })\n    }\n  } else if (req.method === 'GET') {\n    try {\n      const allExpenses = await db.select().from(expenses).all()\n      const normalizedExpenses = allExpenses.map((exp: any) => ({\n        ...exp,\n        amount: Number(exp.amount)\n      }))\n      return res.status(200).json(normalizedExpenses)\n    } catch (error) {\n      console.error('Error fetching expenses:', error)\n      return res.status(500).json({ error: 'Fehler beim Abrufen der Ausgaben', details: String(error) })\n    }\n  } else if (req.method === 'PUT') {\n    try {\n      const { id, category, amount, date, description } = req.body\n      const parsedAmount = Number(amount)\n\n      if (!id || !category || Number.isNaN(parsedAmount)) {\n        return res.status(400).json({ error: 'id, category und amount sind erforderlich' })\n      }\n\n      const updated = await db\n        .update(expenses)\n        .set({\n          category,\n          amount: parsedAmount,\n          date: date || new Date().toISOString().split('T')[0],\n          description: description || null\n        })\n        .where(eq(expenses.id, Number(id)))\n        .returning()\n\n      const normalizedExpense = {\n        ...updated[0],\n        amount: Number(updated[0]?.amount)\n      }\n\n      return res.status(200).json(normalizedExpense)\n    } catch (error) {\n      console.error('Error updating expense:', error)\n      return res.status(500).json({ error: 'Fehler beim Aktualisieren der Ausgabe', details: String(error) })\n    }\n  } else if (req.method === 'DELETE') {\n    try {\n      const { id } = req.query\n      if (!id || isNaN(Number(id))) {\n        return res.status(400).json({ error: 'Ungültige ID' })\n      }\n\n      await db.delete(expenses).where(eq(expenses.id, Number(id))).run()\n      return res.status(200).json({ message: 'Ausgabe gelöscht' })\n    } catch (error) {\n      console.error('Error deleting expense:', error)\n      return res.status(500).json({ error: 'Fehler beim Löschen der Ausgabe', details: String(error) })\n    }\n  } else {\n    return res.status(405).json({ error: 'Method not allowed' })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}