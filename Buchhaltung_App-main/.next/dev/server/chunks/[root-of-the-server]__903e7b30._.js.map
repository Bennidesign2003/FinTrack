{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Buchhaltung_App/Buchhaltung_App-main/db/schema.ts"],"sourcesContent":["import { sqliteTable, text, real, integer, sqliteView } from 'drizzle-orm/sqlite-core'\nimport { sql } from 'drizzle-orm'\n\nexport const invoices = sqliteTable('invoices', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  customer: text('customer').notNull(),\n  title: text('title').notNull().default(''),\n  amount: real('amount').notNull(),\n  taxRate: real('tax_rate').notNull().default(19),\n  taxAmount: real('tax_amount').notNull().default(0),\n  totalAmount: real('total_amount').notNull(),\n  dueDate: text('due_date'),\n  description: text('description'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  updatedAt: text('updated_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  status: text('status').default('open').notNull() // 'open', 'paid', 'overdue'\n})\n\nexport const expenses = sqliteTable('expenses', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  category: text('category').notNull(),\n  amount: real('amount').notNull(),\n  date: text('date'),\n  description: text('description'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull()\n})\n\nexport const customers = sqliteTable('customers', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  name: text('name').notNull().unique(),\n  email: text('email'),\n  phone: text('phone'),\n  address: text('address'),\n  city: text('city'),\n  postalCode: text('postal_code'),\n  country: text('country'),\n  taxId: text('tax_id'),\n  notes: text('notes'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  updatedAt: text('updated_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull()\n})\n\nexport const suppliers = sqliteTable('suppliers', {\n  id: integer('id').primaryKey({ autoIncrement: true }),\n  name: text('name').notNull().unique(),\n  email: text('email'),\n  phone: text('phone'),\n  address: text('address'),\n  city: text('city'),\n  postalCode: text('postal_code'),\n  country: text('country'),\n  taxId: text('tax_id'),\n  notes: text('notes'),\n  createdAt: text('created_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull(),\n  updatedAt: text('updated_at')\n    .default(sql`CURRENT_TIMESTAMP`)\n    .notNull()\n})\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;;;;;;AAEO,MAAM,WAAW,IAAA,+KAAW,EAAC,YAAY;IAC9C,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,UAAU,IAAA,wKAAI,EAAC,YAAY,OAAO;IAClC,OAAO,IAAA,wKAAI,EAAC,SAAS,OAAO,GAAG,OAAO,CAAC;IACvC,QAAQ,IAAA,wKAAI,EAAC,UAAU,OAAO;IAC9B,SAAS,IAAA,wKAAI,EAAC,YAAY,OAAO,GAAG,OAAO,CAAC;IAC5C,WAAW,IAAA,wKAAI,EAAC,cAAc,OAAO,GAAG,OAAO,CAAC;IAChD,aAAa,IAAA,wKAAI,EAAC,gBAAgB,OAAO;IACzC,SAAS,IAAA,wKAAI,EAAC;IACd,aAAa,IAAA,wKAAI,EAAC;IAClB,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,QAAQ,IAAA,wKAAI,EAAC,UAAU,OAAO,CAAC,QAAQ,OAAO,GAAG,4BAA4B;AAC/E;AAEO,MAAM,WAAW,IAAA,+KAAW,EAAC,YAAY;IAC9C,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,UAAU,IAAA,wKAAI,EAAC,YAAY,OAAO;IAClC,QAAQ,IAAA,wKAAI,EAAC,UAAU,OAAO;IAC9B,MAAM,IAAA,wKAAI,EAAC;IACX,aAAa,IAAA,wKAAI,EAAC;IAClB,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;AACZ;AAEO,MAAM,YAAY,IAAA,+KAAW,EAAC,aAAa;IAChD,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,MAAM,IAAA,wKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,SAAS,IAAA,wKAAI,EAAC;IACd,MAAM,IAAA,wKAAI,EAAC;IACX,YAAY,IAAA,wKAAI,EAAC;IACjB,SAAS,IAAA,wKAAI,EAAC;IACd,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;AACZ;AAEO,MAAM,YAAY,IAAA,+KAAW,EAAC,aAAa;IAChD,IAAI,IAAA,2KAAO,EAAC,MAAM,UAAU,CAAC;QAAE,eAAe;IAAK;IACnD,MAAM,IAAA,wKAAI,EAAC,QAAQ,OAAO,GAAG,MAAM;IACnC,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,SAAS,IAAA,wKAAI,EAAC;IACd,MAAM,IAAA,wKAAI,EAAC;IACX,YAAY,IAAA,wKAAI,EAAC;IACjB,SAAS,IAAA,wKAAI,EAAC;IACd,OAAO,IAAA,wKAAI,EAAC;IACZ,OAAO,IAAA,wKAAI,EAAC;IACZ,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;IACV,WAAW,IAAA,wKAAI,EAAC,cACb,OAAO,CAAC,mIAAG,CAAC,iBAAiB,CAAC,EAC9B,OAAO;AACZ"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Buchhaltung_App/Buchhaltung_App-main/db/index.ts"],"sourcesContent":["import Database from 'better-sqlite3'\nimport { drizzle } from 'drizzle-orm/better-sqlite3'\nimport * as schema from './schema'\n\nconst sqlite = new Database('buchhaltung.db')\nexport const db = drizzle(sqlite, { schema })\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,SAAS,IAAI,sIAAQ,CAAC;AACrB,MAAM,KAAK,IAAA,iLAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 164, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Buchhaltung_App/Buchhaltung_App-main/pages/api/invoices.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next'\nimport { db } from '@/db'\nimport { invoices } from '@/db/schema'\nimport { eq } from 'drizzle-orm'\n\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\n  if (req.method === 'POST') {\n    try {\n      const { customer, dueDate, description, title, status } = req.body\n      const amount = Number(req.body.amount)\n      const taxRate = Number(req.body.taxRate ?? 0)\n\n      if (!customer || Number.isNaN(amount)) {\n        return res.status(400).json({ error: 'customer und amount sind erforderlich' })\n      }\n\n      const taxAmount = +(amount * (taxRate / 100))\n      const totalAmount = +(amount + taxAmount)\n\n      const invoice = await db\n        .insert(invoices)\n        .values({\n          customer,\n          title: title || `Rechnung ${new Date().getFullYear()}-${Math.random().toString(36).slice(2, 7)}`,\n          amount,\n          taxRate,\n          taxAmount,\n          totalAmount,\n          dueDate: dueDate || null,\n          description: description || null,\n          status: status === 'paid' || status === 'overdue' ? status : 'open'\n        })\n        .returning()\n\n      const normalizedInvoice = {\n        ...invoice[0],\n        amount: Number(invoice[0]?.amount),\n        taxRate: Number(invoice[0]?.taxRate),\n        taxAmount: Number(invoice[0]?.taxAmount),\n        totalAmount: Number(invoice[0]?.totalAmount),\n        title: invoice[0]?.title || '',\n        status: invoice[0]?.status || 'open'\n      }\n\n      return res.status(201).json(normalizedInvoice)\n    } catch (error) {\n      console.error('Error creating invoice:', error)\n      return res.status(500).json({ error: 'Fehler beim Erstellen der Rechnung', details: String(error) })\n    }\n  } else if (req.method === 'GET') {\n    try {\n      const allInvoices = await db.select().from(invoices).all()\n      const normalizedInvoices = allInvoices.map((inv: any) => ({\n        ...inv,\n        amount: Number(inv.amount),\n        taxRate: Number(inv.taxRate),\n        taxAmount: Number(inv.taxAmount),\n        totalAmount: Number(inv.totalAmount),\n        title: inv.title,\n        status: inv.status || 'open'\n      }))\n      return res.status(200).json(normalizedInvoices)\n    } catch (error) {\n      console.error('Error fetching invoices:', error)\n      return res.status(500).json({ error: 'Fehler beim Abrufen der Rechnungen', details: String(error) })\n    }\n  } else if (req.method === 'PUT') {\n    try {\n      const { id, customer, dueDate, description, title, status } = req.body\n      const amount = Number(req.body.amount)\n      const taxRate = Number(req.body.taxRate ?? 0)\n\n      if (!id || !customer || Number.isNaN(amount)) {\n        return res.status(400).json({ error: 'id, customer und amount sind erforderlich' })\n      }\n\n      const taxAmount = +(amount * (taxRate / 100))\n      const totalAmount = +(amount + taxAmount)\n\n      const updated = await db\n        .update(invoices)\n        .set({\n          customer,\n          title: title || `Rechnung ${new Date().getFullYear()}-${Math.random().toString(36).slice(2, 7)}`,\n          amount,\n          taxRate,\n          taxAmount,\n          totalAmount,\n          dueDate: dueDate || null,\n          description: description || null,\n          updatedAt: new Date().toISOString(),\n          status: status === 'paid' || status === 'overdue' ? status : 'open'\n        })\n        .where(eq(invoices.id, Number(id)))\n        .returning()\n\n      const normalizedInvoice = {\n        ...updated[0],\n        amount: Number(updated[0]?.amount),\n        taxRate: Number(updated[0]?.taxRate),\n        taxAmount: Number(updated[0]?.taxAmount),\n        totalAmount: Number(updated[0]?.totalAmount),\n        title: updated[0]?.title || '',\n        status: updated[0]?.status || 'open'\n      }\n\n      return res.status(200).json(normalizedInvoice)\n    } catch (error) {\n      console.error('Error updating invoice:', error)\n      return res.status(500).json({ error: 'Fehler beim Aktualisieren der Rechnung', details: String(error) })\n    }\n  } else if (req.method === 'DELETE') {\n    try {\n      const { id } = req.query\n      if (!id || isNaN(Number(id))) {\n        return res.status(400).json({ error: 'Ungültige ID' })\n      }\n\n      await db.delete(invoices).where(eq(invoices.id, Number(id))).run()\n      return res.status(200).json({ message: 'Rechnung gelöscht' })\n    } catch (error) {\n      console.error('Error deleting invoice:', error)\n      return res.status(500).json({ error: 'Fehler beim Löschen der Rechnung', details: String(error) })\n    }\n  } else {\n    return res.status(405).json({ error: 'Method not allowed' })\n  }\n}\n"],"names":[],"mappings":"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"}}]
}